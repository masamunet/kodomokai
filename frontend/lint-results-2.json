
> frontend@0.1.0 lint
> eslint --format json

[{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/forgot-password/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/_components/RegisterAccountStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/_components/RegisterChildrenStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/_components/RegisterCompleteStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/_components/RegisterConfirmStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/_components/RegisterParentStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/onboarding/RegistrationWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/onboarding/_components/SetPasswordStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/onboarding/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/register/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/(auth)/update-password/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/admin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/common.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/debug.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/dev_seed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/events.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/forum.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/meetings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/organization.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/profile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/actions/rsvp.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/accounting/[id]/edit/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/accounting/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/accounting/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/accounting.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/constitution.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/event.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/notification.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/officer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/settings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/actions/user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/constitution/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/events/[id]/edit/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/events/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/events/annual/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/events/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/events/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/meetings/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/meetings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/members/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/notifications/new/NotificationForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/notifications/new/TemplateSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/notifications/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/notifications/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/officers/new/AssignmentForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/officers/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/officers/next-year/OfficerSelectionCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/officers/next-year/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/officers/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/roles/RoleList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/roles/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/roles/new/RoleForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/roles/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/roles/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/settings/SettingsForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/templates/new/TemplateForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/templates/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/templates/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/users/[id]/children/[childId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/users/[id]/children/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/users/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/admin/users/import/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/auth/auth-code-error/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/auth/callback/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/auth/signout/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/events/[id]/page.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'participantMap' is never reassigned. Use 'const' instead.","line":30,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":30,"endColumn":42,"fix":{"range":[693,737],"text":"const participantMap: Record<string, any> = {}"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"\nimport { createClient } from '@/lib/supabase/server'\nimport Link from 'next/link'\nimport { submitRsvp } from '../../actions/rsvp'\n\n// Ensure we handle async params correctly for Next.js 15+ \nexport default async function EventPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const supabase = await createClient()\n\n  // Get event details\n  const { data: event } = await supabase\n    .from('events')\n    .select('*')\n    .eq('id', id)\n    .single()\n\n  if (!event) {\n    return <div>イベントが見つかりません</div>\n  }\n\n  // Get current user's children and their rsvp status\n  const { data: { user } } = await supabase.auth.getUser()\n\n  let children: any[] = []\n  let participantMap: Record<string, any> = {}\n\n  if (user) {\n    // 1. Get children\n    const { data: userChildren } = await supabase\n      .from('children')\n      .select('*')\n      .eq('parent_id', user.id)\n      .order('birthday', { ascending: false }) // Sort by age (youngest first usually bottom, but birthday descending means youngest first?) \n      // Usually older child first is better? birthday ascending -> older first\n      .order('created_at', { ascending: true }) // fallback\n\n    // Sort by birthday ascending (Oldest first)\n    if (userChildren) {\n      children = userChildren.sort((a, b) => (a.birthday > b.birthday ? 1 : -1))\n    }\n\n    // 2. Get existing participants records for these children\n    if (children.length > 0) {\n      const { data: participants } = await supabase\n        .from('event_participants')\n        .select('*')\n        .eq('event_id', id)\n        .eq('profile_id', user.id)\n        .not('child_id', 'is', null)\n\n      if (participants) {\n        participants.forEach(p => {\n          if (p.child_id) participantMap[p.child_id] = p\n        })\n      }\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4 sm:p-8\">\n      <div className=\"mx-auto max-w-3xl\">\n        <div className=\"mb-4\">\n          <Link href=\"/\" className=\"text-indigo-600 hover:text-indigo-500\">\n            ← ダッシュボードへ戻る\n          </Link>\n        </div>\n\n        <div className=\"overflow-hidden bg-white shadow sm:rounded-lg\">\n          <div className=\"px-4 py-5 sm:px-6\">\n            <h3 className=\"text-xl font-semibold leading-6 text-gray-900\">{event.title}</h3>\n            <p className=\"mt-1 max-w-2xl text-sm text-gray-500\">{event.type === 'meeting' ? '定例会' : 'イベント'}</p>\n          </div>\n          <div className=\"border-t border-gray-200 px-4 py-5 sm:px-6\">\n            <dl className=\"grid grid-cols-1 gap-x-4 gap-y-8 sm:grid-cols-2\">\n              <div className=\"sm:col-span-1\">\n                <dt className=\"text-sm font-medium text-gray-500\">日時</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">\n                  {new Date(event.scheduled_date).toLocaleDateString()}\n                  {event.start_time && ` ${event.start_time.slice(0, 5)}`}\n                  {event.scheduled_end_date && ` 〜 ${new Date(event.scheduled_end_date).toLocaleDateString()}`}\n                </dd>\n              </div>\n              <div className=\"sm:col-span-1\">\n                <dt className=\"text-sm font-medium text-gray-500\">場所</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">{event.location || '未定'}</dd>\n              </div>\n              <div className=\"sm:col-span-2\">\n                <dt className=\"text-sm font-medium text-gray-500\">詳細</dt>\n                <dd className=\"mt-1 text-sm text-gray-900 whitespace-pre-wrap\">{event.description}</dd>\n              </div>\n            </dl>\n          </div>\n\n          {event.rsvp_required && (\n            <div className=\"border-t border-gray-200 px-4 py-5 sm:px-6 bg-indigo-50/50\">\n              <h4 className=\"text-lg font-bold text-indigo-900\">出欠登録</h4>\n\n              {children.length === 0 ? (\n                <div className=\"mt-4 p-4 bg-yellow-50 rounded border border-yellow-200 text-yellow-800\">\n                  <p>お子様の情報が登録されていません。「マイページ」からお子様を登録してください。</p>\n                  <Link href=\"/profile\" className=\"text-indigo-600 underline mt-2 inline-block\">マイページへ</Link>\n                </div>\n              ) : (\n                <>\n                  {event.rsvp_deadline && (\n                    <p className=\"text-sm text-red-600 mb-4 mt-1\">締切: {new Date(event.rsvp_deadline).toLocaleString()}</p>\n                  )}\n\n                  <form action={submitRsvp} className=\"mt-6 space-y-4\">\n                    <input type=\"hidden\" name=\"event_id\" value={event.id} />\n\n                    <div className=\"bg-white rounded-lg border border-gray-200 divide-y divide-gray-100\">\n                      {children.map(child => {\n                        const rsvp = participantMap[child.id]\n                        const isAttending = rsvp?.status === 'attending'\n\n                        return (\n                          <div key={child.id} className=\"p-4 flex items-center justify-between hover:bg-gray-50 transition-colors\">\n                            <label htmlFor={`status_${child.id}`} className=\"flex items-center gap-4 cursor-pointer flex-1\">\n                              <input\n                                type=\"checkbox\"\n                                id={`status_${child.id}`}\n                                name={`status_${child.id}`}\n                                value=\"attending\"\n                                defaultChecked={isAttending}\n                                className=\"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600 cursor-pointer\"\n                              />\n                              <div className=\"flex flex-col\">\n                                <span className=\"font-bold text-gray-900 text-lg\">{child.full_name} <span className=\"text-sm font-normal text-gray-500\">さん</span></span>\n                                <span className=\"text-sm text-gray-500\">\n                                  参加する場合はチェック\n                                </span>\n                              </div>\n                            </label>\n                          </div>\n                        )\n                      })}\n                    </div>\n\n                    <div className=\"pt-4 flex justify-end\">\n                      <button\n                        type=\"submit\"\n                        className=\"w-full sm:w-auto inline-flex justify-center rounded-md bg-indigo-600 px-8 py-3 text-base font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\"\n                      >\n                        保存する\n                      </button>\n                    </div>\n                  </form>\n                </>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/forum/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/forum/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/login/AuthForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/login/actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/login/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/notifications/read/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/page.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'eventAttendanceMap' is never reassigned. Use 'const' instead.","line":104,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":104,"endColumn":25,"fix":{"range":[3590,3645],"text":"const eventAttendanceMap = new Map<string, Set<string>>()"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server'\nimport Link from 'next/link'\nimport { getTargetFiscalYear } from '@/lib/fiscal-year'\nimport FiscalYearSwitcher from '@/components/FiscalYearSwitcher'\nimport { MessageCircleQuestion, HelpCircle, ChevronRight } from 'lucide-react'\nimport { getUnansweredCount } from '@/app/actions/forum'\nimport GoogleCalendarButton from '@/components/GoogleCalendarButton'\n\nexport default async function DashboardPage() {\n  const supabase = await createClient()\n  const { data: { user } } = await supabase.auth.getUser()\n\n  // user is guaranteed to exist because of middleware redirection\n  const currentUser = user!\n\n  // Get user profile\n  const { data: profile } = await supabase\n    .from('profiles')\n    .select('*')\n    .eq('id', currentUser.id)\n    .single()\n\n  // Get association settings\n  const { data: settings } = await supabase.from('organization_settings').select('name').single()\n  const associationName = settings?.name || '子供会'\n\n  // Get unread notifications\n  const { data: unreadNotifications } = await supabase\n    .from('notification_recipients')\n    .select(`\nid,\n  is_read,\n  read_token,\n  notification: notifications(\n    id,\n    subject,\n    sent_at\n  )\n    `)\n    .eq('profile_id', currentUser.id)\n    .eq('is_read', false)\n    .order('created_at', { ascending: false })\n\n  // Get target fiscal year\n  const targetFiscalYear = await getTargetFiscalYear()\n  const today = new Date().toISOString().split('T')[0]\n  // Ideally, upcoming events should be filtered by the target fiscal year as well?\n  // But usually \"Upcoming\" means \"Future from now\".\n  // However, \"Date Undecided\" events (tentative) might have placeholder dates in the past (e.g. April 1st).\n  // We need to fetch these specifically if they belong to the current/target context.\n\n  // 1. Fetch upcoming confirmed/tentative events (Standard)\n  const { data: upcomingEvents } = await supabase\n    .from('events')\n    .select('*')\n    .gte('scheduled_date', today)\n    .order('scheduled_date', { ascending: true })\n  // No limit as per user request\n\n  // 2. Fetch tentative events that might be hidden because of past placeholder dates\n  // We look for tentative events in the current fiscal year (or target fiscal year) that are BEFORE today.\n  // Assuming targetFiscalYear is the relevant context.\n  const startOfFiscalYear = `${targetFiscalYear}-04-01`\n\n  const { data: pastTentativeEvents } = await supabase\n    .from('events')\n    .select('*')\n    .eq('is_tentative', true)\n    .gte('scheduled_date', startOfFiscalYear)\n    .lt('scheduled_date', today)\n    .order('scheduled_date', { ascending: true })\n\n  // Combine and sort\n  let events = [...(pastTentativeEvents || []), ...(upcomingEvents || [])]\n\n  // Deduplicate just in case (though queries shouldn't overlap)\n  const seenIds = new Set()\n  events = events.filter(e => {\n    if (seenIds.has(e.id)) return false\n    seenIds.add(e.id)\n    return true\n  })\n\n  // Sort by date then time\n  events.sort((a, b) => {\n    if (a.scheduled_date === b.scheduled_date) {\n      return (a.start_time || '') > (b.start_time || '') ? 1 : -1\n    }\n    return a.scheduled_date > b.scheduled_date ? 1 : -1\n  })\n\n  // No slice/limit as per user request\n\n  // Get user's children for granular attendance display\n  const { data: children } = await supabase\n    .from('children')\n    .select('id, first_name')\n    .eq('parent_id', currentUser.id)\n    .order('birthday', { ascending: true }) // Consistent order\n\n  // Get attendance status for these events\n  const eventIds = events.map(e => e.id)\n  // Map<EventId, Set<ChildId>>\n  let eventAttendanceMap = new Map<string, Set<string>>()\n\n  if (currentUser && eventIds.length > 0 && children && children.length > 0) {\n    const { data: participations } = await supabase\n      .from('event_participants')\n      .select('event_id, child_id')\n      .eq('profile_id', currentUser.id)\n      .eq('status', 'attending')\n      .in('event_id', eventIds)\n\n    if (participations) {\n      participations.forEach(p => {\n        if (p.child_id) {\n          if (!eventAttendanceMap.has(p.event_id)) {\n            eventAttendanceMap.set(p.event_id, new Set())\n          }\n          eventAttendanceMap.get(p.event_id)!.add(p.child_id)\n        }\n      })\n    }\n  }\n\n  // Get officer roles FOR THE TARGET FISCAL YEAR\n  const { data: officerRoles } = await supabase\n    .from('officer_role_assignments')\n    .select(`\n  *,\n  role: officer_roles(*)\n    `)\n    .eq('profile_id', currentUser.id)\n    .eq('fiscal_year', targetFiscalYear) // Use target year\n\n  // Secure filter: Hide drafts from non-officers\n  // Although RLS should handle this, we add an explicit filter here for safety.\n  if (!officerRoles || officerRoles.length === 0) {\n    events = events.filter(e => e.public_status !== 'draft')\n  }\n\n  // Get officer tasks if any role\n  let officerTasks: any[] = []\n  let unansweredCount = 0\n  if (officerRoles && officerRoles.length > 0) {\n    const roleIds = officerRoles.map(r => r.role_id)\n    const { data: tasks } = await supabase\n      .from('officer_tasks')\n      .select('*')\n      .in('role_id', roleIds)\n    officerTasks = tasks || []\n\n    // Get unanswered forum questions count\n    unansweredCount = await getUnansweredCount()\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow\">\n        <div className=\"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8 flex flex-col sm:flex-row justify-between items-center gap-4\">\n          <div className=\"flex items-center gap-4\">\n            <h1 className=\"text-3xl font-bold tracking-tight text-gray-900\">ダッシュボード</h1>\n            <FiscalYearSwitcher currentYear={targetFiscalYear} />\n          </div>\n          <div className=\"flex gap-2 sm:gap-4 items-center flex-wrap justify-center\">\n            <Link href=\"/forum\" className=\"text-sm font-semibold leading-6 text-indigo-600 bg-indigo-50 border border-indigo-100 rounded-lg px-3 py-2 hover:bg-indigo-100 transition-colors flex items-center gap-2\">\n              <MessageCircleQuestion size={18} />\n              質問掲示板\n            </Link>\n            {profile?.is_admin && (\n              <Link href=\"/admin/templates\" className=\"text-sm font-semibold leading-6 text-gray-900 border rounded-lg px-3 py-2 hover:bg-gray-50 flex items-center gap-2 text-xs\">\n                管理者メニューへ\n              </Link>\n            )}\n            <Link href=\"/profile\" className=\"text-sm font-semibold leading-6 text-gray-900 border rounded-lg px-3 py-2 hover:bg-gray-50 flex items-center gap-2 text-xs\">\n              マイページ\n            </Link>\n            <form action=\"/auth/signout\" method=\"post\">\n              <button className=\"text-sm font-semibold leading-6 text-gray-900 border rounded-lg px-3 py-2 hover:bg-gray-50 flex items-center gap-2 text-xs\">\n                ログアウト\n              </button>\n            </form>\n          </div>\n        </div>\n      </header>\n      <main>\n        <div className=\"mx-auto max-w-7xl py-6 sm:px-6 lg:px-8\">\n\n          {/* Officer Dashboard Section */}\n          {(officerRoles && officerRoles.length > 0) && (\n            <div className=\"bg-indigo-50 border-l-4 border-indigo-500 p-4 mb-8\">\n              <div className=\"flex flex-col sm:flex-row justify-between items-start gap-4\">\n                <div>\n                  <h2 className=\"text-lg font-bold text-indigo-900\">役員メニュー ({targetFiscalYear}年度)</h2>\n                  <p className=\"text-sm text-indigo-700 mt-1\">\n                    現在の役職: {officerRoles.map((r: any) => r.role?.name).join(', ')}\n                  </p>\n                  {unansweredCount > 0 && (\n                    <Link href=\"/forum\" className=\"inline-flex items-center gap-1.5 mt-2 bg-pink-100 text-pink-700 px-3 py-1 rounded-full text-xs font-bold hover:bg-pink-200 transition-colors\">\n                      <HelpCircle size={14} />\n                      未回答の質問が {unansweredCount} 件あります\n                    </Link>\n                  )}\n                </div>\n                <div className=\"flex gap-2 flex-wrap\">\n                  <Link href=\"/admin/notifications/new\" className=\"bg-white text-indigo-700 px-3 py-1 rounded text-sm font-semibold shadow-sm border hover:bg-gray-50\">\n                    お知らせ作成\n                  </Link>\n                  <Link href=\"/admin/events/new\" className=\"bg-white text-indigo-700 px-3 py-1 rounded text-sm font-semibold shadow-sm border hover:bg-gray-50\">\n                    イベント作成\n                  </Link>\n                  <Link href=\"/admin/members\" className=\"bg-white text-indigo-700 px-3 py-1 rounded text-sm font-semibold shadow-sm border hover:bg-gray-50\">\n                    会員名簿\n                  </Link>\n                </div>\n              </div>\n\n              <div className=\"mt-4\">\n                <h3 className=\"font-semibold text-indigo-900 text-sm mb-2\">担当業務</h3>\n                {officerTasks.length > 0 ? (\n                  <ul className=\"list-disc list-inside text-sm text-indigo-800 bg-white/50 p-3 rounded\">\n                    {officerTasks.map(task => (\n                      <li key={task.id} className=\"mb-1\">\n                        <span className=\"font-medium\">{task.title}</span>\n                        {task.due_date && <span className=\"text-xs ml-2 text-red-600\">期限: {new Date(task.due_date).toLocaleDateString()}</span>}\n                        <p className=\"text-xs text-indigo-600 ml-5\">{task.description}</p>\n                      </li>\n                    ))}\n                  </ul>\n                ) : (\n                  <p className=\"text-sm text-indigo-600\">現在登録されている担当業務はありません。</p>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Notifications Section */}\n          <div className=\"mb-8\">\n            <h2 className=\"text-lg font-medium leading-6 text-gray-900 mb-4\">\n              {unreadNotifications && unreadNotifications.length > 0 ? '未読のお知らせ' : '新しいお知らせはありません'}\n            </h2>\n\n            {unreadNotifications && unreadNotifications.length > 0 && (\n              <div className=\"overflow-hidden rounded-md bg-white shadow\">\n                <ul role=\"list\" className=\"divide-y divide-gray-200\">\n                  {unreadNotifications.map((recipient) => {\n                    const notification = recipient.notification as any\n                    return (\n                      <li key={recipient.id} className=\"px-6 py-4 hover:bg-gray-50\">\n                        <Link href={`/ notifications / read ? token = ${recipient.read_token} `} className=\"block\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"font-medium text-indigo-600\">{notification?.subject}</span>\n                            <span className=\"text-sm text-gray-500\">\n                              {new Date(notification?.sent_at).toLocaleDateString()}\n                            </span>\n                          </div>\n                        </Link>\n                      </li>\n                    )\n                  })}\n                </ul>\n              </div>\n            )}\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3\">\n            <div className=\"col-span-1 sm:col-span-2 bg-white overflow-hidden shadow rounded-lg\">\n              <div className=\"px-4 py-5 sm:px-6\">\n                <h3 className=\"font-semibold text-lg text-gray-900\">イベント予定</h3>\n              </div>\n              <div className=\"border-t border-gray-200\">\n                {events?.length === 0 ? (\n                  <div className=\"px-4 py-5 sm:px-6 text-gray-500\">直近のイベントはありません。</div>\n                ) : (\n                  <ul role=\"list\" className=\"divide-y divide-gray-200\">\n                    {events?.map((event) => {\n                      const isCanceled = event.is_canceled\n                      const status = event.public_status || (event.is_tentative ? 'date_undecided' : 'finalized')\n\n                      return (\n                        <li key={event.id} className={`group relative hover:bg-gray-50 ${isCanceled ? 'bg-gray-50' : ''}`}>\n                          <div className=\"px-4 py-4 sm:px-6\">\n                            <div className=\"flex items-center justify-between\">\n                              {/* Main Content Area - Clickable via absolute link */}\n                              <div className=\"flex flex-col relative z-0\">\n                                <Link href={`/events/${event.id}`} className=\"absolute inset-0 z-10 w-full h-full focus:outline-none\">\n                                  <span className=\"sr-only\">イベント詳細を見る</span>\n                                </Link>\n                                <div className=\"flex items-center gap-2 mb-1 pointer-events-none\">\n                                  {status === 'draft' && (\n                                    <span className=\"inline-flex items-center rounded-md bg-gray-100 px-1.5 py-0.5 text-xs font-bold text-gray-600 ring-1 ring-inset ring-gray-500/10\">下書き</span>\n                                  )}\n                                  {isCanceled && (\n                                    <span className=\"inline-flex items-center rounded-md bg-red-50 px-1.5 py-0.5 text-xs font-bold text-red-700 ring-1 ring-inset ring-red-600/10\">中止</span>\n                                  )}\n                                  {status === 'details_undecided' && !isCanceled && (\n                                    <span className=\"inline-flex items-center rounded-md bg-yellow-50 px-1.5 py-0.5 text-xs font-bold text-yellow-700 ring-1 ring-inset ring-yellow-600/10\">詳細未定</span>\n                                  )}\n\n                                  {/* Child Attendance Icons */}\n                                  {children && children.length > 0 && !isCanceled && (\n                                    <div className=\"flex items-center gap-1 ml-1\" title=\"出席状況\">\n                                      {(children || []).map(child => {\n                                        const isAttending = eventAttendanceMap.get(event.id)?.has(child.id)\n                                        return (\n                                          <div\n                                            key={child.id}\n                                            title={`${child.first_name}: ${isAttending ? '参加' : '参加しない'}`}\n                                            className={`\n                                              flex items-center justify-center w-5 h-5 rounded-full border \n                                              ${isAttending\n                                                ? 'bg-green-100 border-green-200 text-green-700'\n                                                : 'bg-gray-50 border-gray-200 text-gray-300'\n                                              }\n                                            `}\n                                          >\n                                            <span className=\"text-[10px] font-bold\">\n                                              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill={isAttending ? \"currentColor\" : \"none\"} stroke=\"currentColor\" strokeWidth=\"2.5\" className=\"w-3 h-3\">\n                                                <circle cx=\"12\" cy=\"12\" r=\"10\" />\n                                              </svg>\n                                            </span>\n                                          </div>\n                                        )\n                                      })}\n                                    </div>\n                                  )}\n\n                                  <p className={`text-sm font-bold text-indigo-600 truncate ${isCanceled ? 'line-through opacity-50' : ''}`}>{event.title}</p>\n                                </div>\n                                <p className={`mt-1 text-xs text-gray-500 pointer-events-none ${isCanceled ? 'line-through opacity-50' : ''}`}>\n                                  {status === 'date_undecided' ? (\n                                    <span className=\"text-pink-600 font-bold\">【日時未定】</span>\n                                  ) : (\n                                    <>\n                                      {new Date(event.scheduled_date).toLocaleDateString()} {event.start_time ? event.start_time.slice(0, 5) : ''}\n                                    </>\n                                  )}\n                                  {event.location && ` @ ${event.location}`}\n                                </p>\n                              </div>\n\n                              {/* Right Side Actions - z-index higher than link to be clickable */}\n                              <div className=\"flex items-center gap-3 relative z-20\">\n                                {!isCanceled && !event.is_tentative && (\n                                  <GoogleCalendarButton\n                                    title={event.title}\n                                    description={event.description}\n                                    date={event.scheduled_date}\n                                    startTime={event.start_time}\n                                    location={event.location}\n                                    associationName={associationName}\n                                  />\n                                )}\n\n                                {event.rsvp_required && !isCanceled ? (\n                                  <span className=\"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50\">\n                                    詳細・出欠\n                                  </span>\n                                ) : (\n                                  <span className=\"inline-flex items-center rounded-md bg-gray-50 px-2.5 py-1.5 text-xs font-medium text-gray-500 border border-gray-200\">\n                                    {isCanceled ? '受付停止' : '自由参加'}\n                                  </span>\n                                )}\n                                <ChevronRight className=\"h-5 w-5 text-gray-400\" aria-hidden=\"true\" />\n                              </div>\n                            </div>\n                          </div>\n                        </li>\n                      )\n                    })}\n                  </ul>\n                )}\n              </div>\n            </div>\n          </div>\n\n        </div>\n      </main>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/profile/DeleteChildButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/profile/ProfileForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/profile/children/new/ChildForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/profile/children/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/app/profile/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/Breadcrumbs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/FiscalYearSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/GoogleCalendarButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/AdminFormLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/AdminNavLinks.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/AdminPageHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/AnnualScheduleEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/BulkExportButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/ConstitutionEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/EventListEditButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/MeetingEditor.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/MeetingEditor.tsx:59:7\n  57 |   useEffect(() => {\n  58 |     if (defaultItemsExpanded) {\n> 59 |       setExpandedAgendaIds(agendas.map(a => a.id))\n     |       ^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  60 |     } else {\n  61 |       // If default is false, we don't necessarily want to close everything if user opened some?\n  62 |       // But if we navigate FROM Detail TO List, we probably want to reset.","line":59,"column":7,"nodeType":null,"endLine":59,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'agendas'. Either include it or remove the dependency array. If 'setExpandedAgendaIds' needs the current value of 'agendas', you can also switch to useReducer instead of useState and read 'agendas' in the reducer.","line":65,"column":6,"nodeType":"ArrayExpression","endLine":65,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [defaultItemsExpanded, agendas.length, agendas]","fix":{"range":[2465,2503],"text":"[defaultItemsExpanded, agendas.length, agendas]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useTransition, useEffect } from 'react'\nimport { upsertRegularMeeting, upsertMeetingAgenda, deleteMeetingAgenda, copyAgendasFromPreviousYear } from '@/app/actions/meetings'\nimport { generateGoogleCalendarUrl } from '@/lib/calendar'\nimport MarkdownEditor from '@/components/ui/MarkdownEditor'\nimport CopyLinkButton from '@/components/ui/CopyLinkButton'\nimport ReactMarkdown from 'react-markdown'\nimport remarkGfm from 'remark-gfm'\nimport { Calendar, ChevronDown, ChevronUp } from 'lucide-react'\nimport Link from 'next/link'\n\ntype Meeting = {\n  id: string\n  target_year: number\n  target_month: number\n  scheduled_date: string | null\n  start_time: string | null\n  location: string | null\n  description: string | null\n}\n\ntype Agenda = {\n  id: string\n  title: string\n  description: string | null\n  display_order: number\n}\n\ntype Props = {\n  year: number\n  month: number\n  meeting?: Meeting\n  agendas: Agenda[]\n  defaultItemsExpanded?: boolean\n}\n\nexport default function MeetingEditor({ year, month, meeting, agendas, defaultItemsExpanded = false }: Props) {\n  const [isEditingSchedule, setIsEditingSchedule] = useState(false)\n  const [isAddingAgenda, setIsAddingAgenda] = useState(false)\n  const [isAgendasExpanded, setIsAgendasExpanded] = useState(true) // Default Section to OPEN\n  const [editingAgendaId, setEditingAgendaId] = useState<string | null>(null)\n\n  // Lifted state for expanded agenda items\n  // Initialize with all IDs if defaultItemsExpanded is true, otherwise empty\n  const [expandedAgendaIds, setExpandedAgendaIds] = useState<string[]>(() =>\n    defaultItemsExpanded ? agendas.map(a => a.id) : []\n  )\n\n  const [isPending, startTransition] = useTransition()\n\n  // Sync expandedAgendaIds if agendas change (e.g. newly added item) IF we are in \"Always Expand\" mode? \n  // Or just rely on user interaction. \n  // Let's ensure that if we navigate from List to Detail, the state re-initializes correctly (key change or mount).\n  // Next.js navigation preserves state if component tree is identical. \n  // We might want to use a useEffect to enforce defaultItemsExpanded behavior on prop change.\n  useEffect(() => {\n    if (defaultItemsExpanded) {\n      setExpandedAgendaIds(agendas.map(a => a.id))\n    } else {\n      // If default is false, we don't necessarily want to close everything if user opened some?\n      // But if we navigate FROM Detail TO List, we probably want to reset.\n      setExpandedAgendaIds([])\n    }\n  }, [defaultItemsExpanded, agendas.length]) // Re-eval if count changes or prop changes\n\n  const toggleAgendaExpansion = (id: string) => {\n    setExpandedAgendaIds(prev =>\n      prev.includes(id) ? prev.filter(pid => pid !== id) : [...prev, id]\n    )\n  }\n\n  // Schedule Form State\n  const [scheduleForm, setScheduleForm] = useState({\n    scheduled_date: meeting?.scheduled_date || '',\n    start_time: meeting?.start_time || '',\n    location: meeting?.location || '',\n    description: meeting?.description || '',\n  })\n\n  const handleScheduleSubmit = async (formData: FormData) => {\n    formData.append('target_year', year.toString())\n    formData.append('target_month', month.toString())\n    if (meeting?.id) formData.append('id', meeting.id)\n\n    startTransition(async () => {\n      const result = await upsertRegularMeeting(formData)\n      if (result.success) {\n        setIsEditingSchedule(false)\n      } else {\n        alert(result.message)\n      }\n    })\n  }\n\n  const handleCopyAgendas = async () => {\n    if (!meeting?.id) return\n    if (!confirm('昨年度の同月の議題をコピーしますか？')) return\n\n    startTransition(async () => {\n      const result = await copyAgendasFromPreviousYear(meeting.id)\n      if (!result.success) {\n        alert(result.message)\n      }\n    })\n  }\n\n  const handleDeleteAgenda = async (id: string) => {\n    if (!confirm('この議題を削除しますか？')) return\n    const formData = new FormData()\n    formData.append('id', id)\n    startTransition(async () => {\n      await deleteMeetingAgenda(formData)\n    })\n  }\n\n  return (\n    <div className=\"bg-card shadow-sm rounded-lg p-6 mb-6 border border-border\">\n      <div className=\"flex justify-between items-start mb-4\">\n        <div>\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"text-xl font-bold text-foreground flex items-center gap-2\">\n              <span className=\"bg-muted text-muted-foreground text-sm font-medium px-2.5 py-0.5 rounded\">{month}月</span>\n              {meeting?.id ? (\n                <Link href={`/admin/meetings/${meeting.id}`} className=\"hover:underline hover:text-primary transition-colors\">\n                  {meeting?.scheduled_date ? new Date(meeting.scheduled_date).toLocaleDateString('ja-JP', { weekday: 'short', month: 'short', day: 'numeric' }) : '日程未定'}\n                </Link>\n              ) : (\n                <span>\n                  {meeting?.scheduled_date ? new Date(meeting.scheduled_date).toLocaleDateString('ja-JP', { weekday: 'short', month: 'short', day: 'numeric' }) : '日程未定'}\n                </span>\n              )}\n            </h3>\n          </div>\n          <div className=\"text-sm text-muted-foreground mt-1\">\n            {meeting?.start_time?.slice(0, 5) || '--:--'} @ {meeting?.location || '場所未定'}\n          </div>\n          {meeting?.description && <div className=\"text-sm text-muted-foreground mt-1\">{meeting.description}</div>}\n\n          {meeting?.id && (\n            <div className=\"mt-2\">\n              <CopyLinkButton meetingId={meeting.id} />\n            </div>\n          )}\n        </div>\n        <button\n          onClick={() => setIsEditingSchedule(!isEditingSchedule)}\n          className=\"text-sm bg-muted hover:bg-muted/80 text-muted-foreground px-3 py-1 rounded transition-colors\"\n        >\n          {isEditingSchedule ? 'キャンセル' : '日程編集'}\n        </button>\n      </div>\n\n      {meeting?.scheduled_date && (\n        <div className=\"mb-4\">\n          <a\n            href={generateGoogleCalendarUrl(meeting)}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className=\"inline-flex items-center gap-1 text-sm text-indigo-600 hover:text-indigo-800 hover:underline\"\n          >\n            <Calendar size={14} />\n            Googleカレンダーに登録\n          </a>\n        </div>\n      )}\n\n      {isEditingSchedule && (\n        <form action={handleScheduleSubmit} className=\"mb-6 bg-muted/50 p-4 rounded-lg border border-border\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-foreground\">開催日</label>\n              <input type=\"date\" name=\"scheduled_date\" defaultValue={scheduleForm.scheduled_date} className=\"mt-1 block w-full rounded-md border-input bg-background shadow-sm focus:border-ring focus:ring-ring text-foreground\" />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-foreground\">開始時間</label>\n              <input type=\"time\" name=\"start_time\" defaultValue={scheduleForm.start_time || ''} className=\"mt-1 block w-full rounded-md border-input bg-background shadow-sm focus:border-ring focus:ring-ring text-foreground\" />\n            </div>\n            <div className=\"md:col-span-2\">\n              <label className=\"block text-sm font-medium text-foreground\">場所</label>\n              <input type=\"text\" name=\"location\" defaultValue={scheduleForm.location} placeholder=\"例: 公民館 第1会議室\" className=\"mt-1 block w-full rounded-md border-input bg-background shadow-sm focus:border-ring focus:ring-ring text-foreground\" />\n            </div>\n            <div className=\"md:col-span-2\">\n              <label className=\"block text-sm font-medium text-foreground\">備考</label>\n              <textarea name=\"description\" defaultValue={scheduleForm.description} className=\"mt-1 block w-full rounded-md border-input bg-background shadow-sm focus:border-ring focus:ring-ring text-foreground\" rows={2}></textarea>\n            </div>\n          </div>\n          <div className=\"mt-4 text-right\">\n            <button type=\"submit\" disabled={isPending} className=\"bg-indigo-600 text-white py-2 px-4 rounded hover:bg-indigo-500 disabled:opacity-50\">\n              保存\n            </button>\n          </div>\n        </form>\n      )}\n\n      {/* Agendas Section */}\n      <div className=\"border-t border-border pt-4 mt-4\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <div\n            className=\"flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity\"\n            onClick={() => setIsAgendasExpanded(!isAgendasExpanded)}\n          >\n            <h4 className=\"font-bold text-foreground flex items-center gap-2\">\n              議題\n              {isAgendasExpanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </h4>\n            {!isAgendasExpanded && agendas.length > 0 && (\n              <span className=\"text-xs bg-muted text-muted-foreground px-2 py-0.5 rounded-full\">\n                {agendas.length}件\n              </span>\n            )}\n          </div>\n          <div className=\"flex gap-2\">\n            {agendas.length === 0 && meeting?.id && (\n              <button\n                type=\"button\"\n                onClick={handleCopyAgendas}\n                disabled={isPending}\n                className=\"text-sm text-indigo-600 hover:text-indigo-500 disabled:opacity-50\"\n              >\n                昨年度からコピー\n              </button>\n            )}\n            <button\n              onClick={() => {\n                setIsAgendasExpanded(true)\n                setIsAddingAgenda(!isAddingAgenda)\n              }}\n              className=\"text-sm bg-muted text-indigo-600 px-3 py-1 rounded hover:bg-muted/80\"\n            >\n              + 議題追加\n            </button>\n          </div>\n        </div>\n\n        {isAgendasExpanded && (\n          <>\n            {isAddingAgenda && (\n              <AgendaForm\n                meetingId={meeting?.id}\n                defaultDisplayOrder={agendas.length > 0 ? Math.max(...agendas.map(a => a.display_order)) + 1 : 1}\n                onCancel={() => setIsAddingAgenda(false)}\n                onComplete={() => setIsAddingAgenda(false)}\n              />\n            )}\n\n            <div className=\"space-y-3\">\n              {agendas.map(agenda => (\n                <div key={agenda.id} className=\"bg-card p-3 border border-border rounded shadow-sm hover:shadow-md transition-shadow\">\n                  {editingAgendaId === agenda.id ? (\n                    <AgendaForm\n                      meetingId={meeting?.id}\n                      agenda={agenda}\n                      onCancel={() => setEditingAgendaId(null)}\n                      onComplete={() => setEditingAgendaId(null)}\n                    />\n                  ) : (\n                    <AgendaItemView\n                      agenda={agenda}\n                      isExpanded={expandedAgendaIds.includes(agenda.id)}\n                      onToggle={() => toggleAgendaExpansion(agenda.id)}\n                      onEdit={() => setEditingAgendaId(agenda.id)}\n                      onDelete={() => handleDeleteAgenda(agenda.id)}\n                    />\n                  )}\n                </div>\n              ))}\n              {agendas.length === 0 && !isAddingAgenda && (\n                <div className=\"text-center text-muted-foreground py-4 text-sm\">\n                  議題は登録されていません\n                </div>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction AgendaItemView({ agenda, isExpanded, onToggle, onEdit, onDelete }: { agenda: Agenda, isExpanded: boolean, onToggle: () => void, onEdit: () => void, onDelete: () => void }) {\n  return (\n    <div className=\"flex justify-between items-start\">\n      <div className=\"flex-1\">\n        <div\n          className=\"font-medium text-foreground flex items-center gap-2 cursor-pointer hover:text-primary transition-colors\"\n          onClick={onToggle}\n        >\n          {agenda.title}\n          <span className=\"text-muted-foreground\">\n            {isExpanded ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\n          </span>\n        </div>\n        {isExpanded && (\n          <div className=\"text-sm text-muted-foreground mt-2 prose prose-sm dark:prose-invert max-w-none\">\n            {agenda.description ? (\n              <ReactMarkdown remarkPlugins={[remarkGfm]}>{agenda.description}</ReactMarkdown>\n            ) : (\n              <span className=\"text-muted-foreground/50 italic\">(詳細なし)</span>\n            )}\n          </div>\n        )}\n      </div>\n      <div className=\"flex gap-2 ml-4\">\n        <button onClick={onEdit} className=\"text-muted-foreground hover:text-primary\">\n          ✎\n        </button>\n        <button onClick={onDelete} className=\"text-muted-foreground hover:text-destructive\">\n          🗑\n        </button>\n      </div>\n    </div>\n  )\n}\n\nfunction AgendaForm({ meetingId, agenda, defaultDisplayOrder = 1, onCancel, onComplete }: { meetingId?: string, agenda?: Agenda, defaultDisplayOrder?: number, onCancel: () => void, onComplete: () => void }) {\n  const [isPending, startTransition] = useTransition()\n\n  if (!meetingId) {\n    return <div className=\"text-destructive text-sm p-2\">先に定例会の日程を保存してください（スケジュール未登録の場合は議題を追加できません）</div>\n  }\n\n  const handleSubmit = async (formData: FormData) => {\n    formData.append('meeting_id', meetingId)\n    if (agenda?.id) formData.append('id', agenda.id)\n\n    startTransition(async () => {\n      await upsertMeetingAgenda(formData)\n      onComplete()\n    })\n  }\n\n  return (\n    <form action={handleSubmit} className=\"bg-muted/30 p-3 rounded mb-3 border border-border\">\n      <div className=\"grid gap-3\">\n        <div>\n          <input\n            name=\"title\"\n            defaultValue={agenda?.title}\n            placeholder=\"議題タイトル\"\n            required\n            className=\"w-full rounded border-input bg-background focus:border-ring focus:ring-ring text-foreground\"\n          />\n        </div>\n      </div>\n      <div>\n        <MarkdownEditor\n          name=\"description\"\n          defaultValue={agenda?.description || ''}\n          placeholder=\"詳細（Markdown対応）\"\n          rows={6}\n        />\n      </div>\n      <div>\n        <div>\n          <input\n            type=\"number\"\n            name=\"display_order\"\n            defaultValue={agenda?.display_order || defaultDisplayOrder}\n            placeholder=\"表示順 (0, 1, 2...)\"\n            className=\"w-24 rounded border-input bg-background focus:border-ring focus:ring-ring text-sm text-foreground\"\n          />\n        </div>\n      </div>\n      <div className=\"flex justify-end gap-2 mt-3\">\n        <button type=\"button\" onClick={onCancel} className=\"text-sm text-muted-foreground hover:text-foreground\">キャンセル</button>\n        <button type=\"submit\" disabled={isPending} className=\"text-sm bg-indigo-600 text-white px-3 py-1 rounded hover:bg-indigo-500 disabled:opacity-50\">\n          保存\n        </button>\n      </div>\n    </form>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/PrintButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/RoleScheduleEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/SingleEventForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/accounting/AccountingEditor.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/accounting/AccountingEditor.tsx:32:7\n  30 |     // If an accountant is assigned via role, force it.\n  31 |     if (accountingInfo.accountantName) {\n> 32 |       setAccountant(accountingInfo.accountantName)\n     |       ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  33 |     }\n  34 |   }, [accountingInfo])\n  35 |","line":32,"column":7,"nodeType":null,"endLine":32,"endColumn":20},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/accounting/AccountingEditor.tsx:72:7\n  70 |     if (!initialData) {\n  71 |       const typeLabel = reportType === 'settlement' ? '決算報告書' : '予算案'\n> 72 |       setTitle(`${fiscalYear}年度 会計${typeLabel}`)\n     |       ^^^^^^^^ Avoid calling setState() directly within an effect\n  73 |     }\n  74 |   }, [fiscalYear, reportType, initialData])\n  75 |","line":72,"column":7,"nodeType":null,"endLine":72,"endColumn":15}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { AccountingItem, FiscalReportPayload, upsertFiscalReport } from '@/app/admin/actions/accounting'\n\ninterface Props {\n  initialData?: any\n  currentYear: number\n  accountingInfo: {\n    canAudit: boolean\n    accountantName: string | null\n    auditorNames: string[]\n    currentAuditorName: string | null\n  }\n}\n\nexport default function AccountingEditor({ initialData, currentYear, accountingInfo }: Props) {\n  const router = useRouter()\n  const [loading, setLoading] = useState(false)\n  const [fiscalYear, setFiscalYear] = useState(initialData?.fiscal_year || currentYear)\n  const [reportType, setReportType] = useState<'settlement' | 'budget'>(initialData?.report_type || 'settlement')\n  const [title, setTitle] = useState(initialData?.title || `${currentYear}年度 会計決算報告書`)\n  const [accountant, setAccountant] = useState(initialData?.accountant_name || accountingInfo.accountantName || '')\n  const [auditorNames, setAuditorNames] = useState<string>(initialData?.auditor_names?.join('／') || '')\n  const [reportDate, setReportDate] = useState(initialData?.report_date || new Date().toISOString().split('T')[0])\n  const [isAudited, setIsAudited] = useState<boolean>(initialData?.is_audited || false)\n\n  useEffect(() => {\n    // If an accountant is assigned via role, force it.\n    if (accountingInfo.accountantName) {\n      setAccountant(accountingInfo.accountantName)\n    }\n  }, [accountingInfo])\n\n  const toggleMySignature = (checked: boolean) => {\n    if (!accountingInfo.currentAuditorName) return\n\n    const currentNames = auditorNames.split('／').filter(n => n.trim() !== '')\n    let newNames: string[] = []\n\n    if (checked) {\n      // Add if not exists\n      if (!currentNames.includes(accountingInfo.currentAuditorName)) {\n        newNames = [...currentNames, accountingInfo.currentAuditorName]\n      } else {\n        newNames = currentNames\n      }\n    } else {\n      // Remove\n      newNames = currentNames.filter(n => n !== accountingInfo.currentAuditorName)\n    }\n    setAuditorNames(newNames.join('／'))\n  }\n\n  const [incomeItems, setIncomeItems] = useState<AccountingItem[]>(\n    initialData?.items?.filter((i: any) => i.category === 'income') || [\n      { category: 'income', item_name: '前年度繰越金', budget_amount: 0, actual_amount: 0, description: '', sort_order: 0 }\n    ]\n  )\n\n  const [expenseItems, setExpenseItems] = useState<AccountingItem[]>(\n    initialData?.items?.filter((i: any) => i.category === 'expense') || [\n      { category: 'expense', item_name: '', budget_amount: 0, actual_amount: 0, description: '', sort_order: 0 }\n    ]\n  )\n\n  // Title auto-update if year/type changes and title is default\n  useEffect(() => {\n    if (!initialData) {\n      const typeLabel = reportType === 'settlement' ? '決算報告書' : '予算案'\n      setTitle(`${fiscalYear}年度 会計${typeLabel}`)\n    }\n  }, [fiscalYear, reportType, initialData])\n\n  const addItem = (category: 'income' | 'expense') => {\n    const newItem: AccountingItem = {\n      category,\n      item_name: '',\n      budget_amount: 0,\n      actual_amount: 0,\n      description: '',\n      sort_order: (category === 'income' ? incomeItems : expenseItems).length\n    }\n    if (category === 'income') setIncomeItems([...incomeItems, newItem])\n    else setExpenseItems([...expenseItems, newItem])\n  }\n\n  const removeItem = (category: 'income' | 'expense', index: number) => {\n    if (category === 'income') {\n      const newItems = [...incomeItems]\n      newItems.splice(index, 1)\n      setIncomeItems(newItems)\n    } else {\n      const newItems = [...expenseItems]\n      newItems.splice(index, 1)\n      setExpenseItems(newItems)\n    }\n  }\n\n  const updateItem = (category: 'income' | 'expense', index: number, field: keyof AccountingItem, value: any) => {\n    const list = category === 'income' ? [...incomeItems] : [...expenseItems]\n    list[index] = { ...list[index], [field]: value }\n    if (category === 'income') setIncomeItems(list)\n    else setExpenseItems(list)\n  }\n\n  const formatCurrency = (val: number) => {\n    return new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(val)\n  }\n\n  // Calculations\n  const calcSubtotal = (items: AccountingItem[], field: 'budget_amount' | 'actual_amount') => {\n    return items.reduce((sum, item) => sum + (Number(item[field]) || 0), 0)\n  }\n\n  const incomeBudgetSubtotal = calcSubtotal(incomeItems, 'budget_amount')\n  const incomeActualSubtotal = calcSubtotal(incomeItems, 'actual_amount')\n  const expenseBudgetSubtotal = calcSubtotal(expenseItems, 'budget_amount')\n  const expenseActualSubtotal = calcSubtotal(expenseItems, 'actual_amount')\n\n  const handleSave = async () => {\n    setLoading(true)\n    const payload: FiscalReportPayload = {\n      fiscal_year: Number(fiscalYear),\n      report_type: reportType,\n      title,\n      accountant_name: accountant,\n      auditor_names: auditorNames.split('／').filter(n => n.trim() !== ''),\n      report_date: reportDate,\n      items: [...incomeItems, ...expenseItems].map((item, idx) => ({ ...item, sort_order: idx })),\n      is_audited: isAudited\n    }\n\n    const res = await upsertFiscalReport(initialData?.id || null, payload)\n    setLoading(false)\n    if (res.success) {\n      alert(res.message)\n      router.push('/admin/accounting')\n      router.refresh()\n    } else {\n      alert(res.message)\n    }\n  }\n\n  const formatDateJP = (dateStr: string) => {\n    if (!dateStr) return ''\n    const d = new Date(dateStr)\n    return `${d.getFullYear()}年${d.getMonth() + 1}月${d.getDate()}日`\n  }\n\n  return (\n    <>\n      <div className=\"space-y-8 print:hidden\">\n        {/* Header Info */}\n        <div className=\"bg-card border border-border p-6 rounded-xl space-y-4 shadow-sm\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-semibold text-muted-foreground ml-1\">対象年度</label>\n              <input\n                type=\"number\"\n                value={fiscalYear}\n                onChange={(e) => setFiscalYear(e.target.value)}\n                className=\"w-full bg-background border border-input rounded-md px-4 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-semibold text-muted-foreground ml-1\">種類</label>\n              <select\n                value={reportType}\n                onChange={(e) => setReportType(e.target.value as any)}\n                className=\"w-full bg-background border border-input rounded-md px-4 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all\"\n              >\n                <option value=\"settlement\">決算報告</option>\n                <option value=\"budget\">予算案</option>\n              </select>\n            </div>\n            <div className=\"md:col-span-2 space-y-2\">\n              <label className=\"text-sm font-semibold text-muted-foreground ml-1\">報告書タイトル</label>\n              <input\n                type=\"text\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n                className=\"w-full bg-background border border-input rounded-md px-4 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Sections */}\n        {(['income', 'expense'] as const).map((category) => (\n          <section key={category} className=\"space-y-4\">\n            <div className=\"flex items-center justify-between px-1\">\n              <h3 className=\"text-lg font-bold text-foreground\">\n                {category === 'income' ? '収入の部' : '支出の部'}\n              </h3>\n              <button\n                onClick={() => addItem(category)}\n                className=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2\"\n              >\n                ＋ 行を追加\n              </button>\n            </div>\n\n            <div className=\"rounded-md border border-border overflow-hidden shadow-sm overflow-x-auto\">\n              <table className=\"w-full text-left border-collapse text-sm min-w-[800px]\">\n                <thead>\n                  <tr className=\"bg-muted/50 border-b border-border\">\n                    <th className=\"px-4 py-3 font-semibold text-muted-foreground\">項目名</th>\n                    <th className=\"px-4 py-3 font-semibold text-muted-foreground text-right w-32\">予算額</th>\n                    <th className=\"px-4 py-3 font-semibold text-muted-foreground text-right w-32\">決算額</th>\n                    <th className=\"px-4 py-3 font-semibold text-muted-foreground\">摘要</th>\n                    <th className=\"px-4 py-3 w-10\"></th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-border bg-card\">\n                  {(category === 'income' ? incomeItems : expenseItems).map((item, idx) => (\n                    <tr key={idx} className=\"group hover:bg-muted/30 transition-colors\">\n                      <td className=\"p-1\">\n                        <input\n                          type=\"text\"\n                          value={item.item_name}\n                          onChange={(e) => updateItem(category, idx, 'item_name', e.target.value)}\n                          className=\"w-full bg-transparent border-none rounded-md px-3 py-2 text-foreground focus:ring-1 focus:ring-primary transition-all\"\n                          placeholder=\"項目名を入力...\"\n                        />\n                      </td>\n                      <td className=\"p-1\">\n                        <input\n                          type=\"number\"\n                          value={item.budget_amount}\n                          onChange={(e) => updateItem(category, idx, 'budget_amount', Number(e.target.value))}\n                          className=\"w-full bg-transparent border-none rounded-md px-3 py-2 text-foreground text-right focus:ring-1 focus:ring-primary transition-all\"\n                        />\n                      </td>\n                      <td className=\"p-1\">\n                        <input\n                          type=\"number\"\n                          value={item.actual_amount}\n                          onChange={(e) => updateItem(category, idx, 'actual_amount', Number(e.target.value))}\n                          className=\"w-full bg-transparent border-none rounded-md px-3 py-2 text-foreground text-right focus:ring-1 focus:ring-primary transition-all\"\n                        />\n                      </td>\n                      <td className=\"p-1\">\n                        <input\n                          type=\"text\"\n                          value={item.description}\n                          onChange={(e) => updateItem(category, idx, 'description', e.target.value)}\n                          className=\"w-full bg-transparent border-none rounded-md px-3 py-2 text-muted-foreground text-sm focus:ring-1 focus:ring-primary transition-all\"\n                          placeholder=\"摘要...\"\n                        />\n                      </td>\n                      <td className=\"p-1\">\n                        <button\n                          onClick={() => removeItem(category, idx)}\n                          className=\"p-2 text-muted-foreground/30 hover:text-destructive opacity-0 group-hover:opacity-100 transition-all\"\n                        >\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" /></svg>\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                  {/* Subtotal Row */}\n                  <tr className=\"bg-muted/20 font-bold border-t border-border\">\n                    <td className=\"px-4 py-3 text-foreground\">小計</td>\n                    <td className=\"px-4 py-3 text-right text-foreground\">\n                      {formatCurrency(category === 'income' ? incomeBudgetSubtotal : expenseBudgetSubtotal)}\n                    </td>\n                    <td className=\"px-4 py-3 text-right text-foreground\">\n                      {formatCurrency(category === 'income' ? incomeActualSubtotal : expenseActualSubtotal)}\n                    </td>\n                    <td colSpan={2}></td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </section>\n        ))}\n\n        {/* Result Section */}\n        <section className=\"bg-card border border-border p-8 rounded-xl space-y-6 shadow-sm\">\n          <h3 className=\"text-xl font-bold text-foreground border-b border-border pb-4\">収支差引合計（次年度繰越）</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-12 pt-2\">\n            <div className=\"space-y-4\">\n              <div className=\"flex justify-between text-muted-foreground text-sm\">\n                <span>収入合計 (決算額)</span>\n                <span className=\"font-medium text-foreground\">{formatCurrency(incomeActualSubtotal)}</span>\n              </div>\n              <div className=\"flex justify-between text-muted-foreground text-sm\">\n                <span>支出合計 (決算額)</span>\n                <span className=\"font-medium text-foreground\">- {formatCurrency(expenseActualSubtotal)}</span>\n              </div>\n              <div className=\"pt-4 border-t border-border flex justify-between font-bold text-2xl text-primary\">\n                <span>次年度繰越金</span>\n                <span>{formatCurrency(incomeActualSubtotal - expenseActualSubtotal)}</span>\n              </div>\n            </div>\n\n            <div className=\"space-y-6 md:border-l md:border-border md:pl-12\">\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-semibold text-muted-foreground\">会計担当者</label>\n                <div className=\"text-xs text-muted-foreground mb-1\">\n                  ※ 役職設定で「会計担当」に設定されたユーザーが自動表示されます\n                </div>\n                <input\n                  type=\"text\"\n                  value={accountant}\n                  readOnly\n                  disabled\n                  placeholder=\"（役職設定から会計担当を割り当ててください）\"\n                  className=\"w-full bg-muted/50 border border-input rounded-md px-4 py-2 text-foreground/70 cursor-not-allowed focus:outline-none\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-semibold text-muted-foreground\">会計監査</label>\n                <div className=\"space-y-3\">\n                  <div className=\"text-xs text-muted-foreground mb-1\">\n                    ※ 会計監査が署名したら表示されます\n                  </div>\n                  <input\n                    type=\"text\"\n                    value={auditorNames}\n                    readOnly\n                    disabled\n                    placeholder=\"（役職設定から会計監査を割り当ててください）\"\n                    className=\"w-full bg-muted/50 border border-input rounded-md px-4 py-2 text-foreground/70 cursor-not-allowed focus:outline-none\"\n                  />\n\n                  {accountingInfo.canAudit && accountingInfo.currentAuditorName && (\n                    <div className=\"flex items-center gap-2 mt-4 p-3 bg-primary/5 border border-primary/20 rounded-md\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"auditCheck\"\n                        checked={auditorNames.includes(accountingInfo.currentAuditorName)}\n                        onChange={(e) => toggleMySignature(e.target.checked)}\n                        className=\"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary\"\n                      />\n                      <label htmlFor=\"auditCheck\" className=\"text-sm font-bold text-foreground cursor-pointer select-none\">\n                        会計監査の署名を入れる（{accountingInfo.currentAuditorName}）\n                      </label>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-semibold text-muted-foreground\">報告日</label>\n                <input\n                  type=\"date\"\n                  value={reportDate}\n                  onChange={(e) => setReportDate(e.target.value)}\n                  className=\"w-full bg-background border border-input rounded-md px-4 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50\"\n                />\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Actions */}\n        <div className=\"flex justify-end gap-3 pt-6 border-t border-border mt-10\">\n          <button\n            type=\"button\"\n            onClick={() => window.print()}\n            className=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-11 px-6 gap-2\"\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\" /></svg>\n            印刷 / PDFプレビュー\n          </button>\n          <button\n            onClick={() => router.back()}\n            className=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-11 px-8\"\n          >\n            キャンセル\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={loading}\n            className=\"inline-flex items-center justify-center rounded-md text-sm font-bold ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-11 px-10 shadow-sm\"\n          >\n            {loading ? '保存中...' : '報告書を保存'}\n          </button>\n        </div>\n      </div>\n\n      {/* Print Layout */}\n      <div className=\"hidden print:block font-serif text-black p-4 max-w-[210mm] mx-auto\">\n        <h1 className=\"text-xl font-bold text-center mb-2 border-b border-black/50 pb-1\">{title}</h1>\n\n        <div className=\"flex gap-4\">\n          {/* Income Items */}\n          <div className=\"flex-1 mb-4\">\n            <h2 className=\"text-base font-bold border-b border-black mb-1\">収入の部</h2>\n            <table className=\"w-full text-xs border-collapse\">\n              <thead>\n                <tr className=\"border-b border-black\">\n                  <th className=\"text-left py-0.5 w-[35%]\">項目</th>\n                  <th className=\"text-right py-0.5 w-[15%]\">予算額</th>\n                  <th className=\"text-right py-0.5 w-[15%]\">決算額</th>\n                  <th className=\"text-left py-0.5 pl-2\">摘要</th>\n                </tr>\n              </thead>\n              <tbody>\n                {incomeItems.map((item, idx) => (\n                  <tr key={idx} className=\"border-b border-black/10\">\n                    <td className=\"py-0.5\">{item.item_name}</td>\n                    <td className=\"text-right py-0.5\">{formatCurrency(item.budget_amount)}</td>\n                    <td className=\"text-right py-0.5\">{formatCurrency(item.actual_amount)}</td>\n                    <td className=\"py-0.5 pl-2 text-[10px]\">{item.description}</td>\n                  </tr>\n                ))}\n                <tr className=\"border-t border-black font-bold\">\n                  <td className=\"py-1\">小計</td>\n                  <td className=\"text-right py-1\">{formatCurrency(incomeBudgetSubtotal)}</td>\n                  <td className=\"text-right py-1\">{formatCurrency(incomeActualSubtotal)}</td>\n                  <td></td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* Expense Items */}\n        <div className=\"mb-4\">\n          <h2 className=\"text-base font-bold border-b border-black mb-1\">支出の部</h2>\n          <table className=\"w-full text-xs border-collapse\">\n            <thead>\n              <tr className=\"border-b border-black\">\n                <th className=\"text-left py-0.5 w-[35%]\">項目</th>\n                <th className=\"text-right py-0.5 w-[15%]\">予算額</th>\n                <th className=\"text-right py-0.5 w-[15%]\">決算額</th>\n                <th className=\"text-left py-0.5 pl-2\">摘要</th>\n              </tr>\n            </thead>\n            <tbody>\n              {expenseItems.map((item, idx) => (\n                <tr key={idx} className=\"border-b border-black/10\">\n                  <td className=\"py-0.5\">{item.item_name}</td>\n                  <td className=\"text-right py-0.5\">{formatCurrency(item.budget_amount)}</td>\n                  <td className=\"text-right py-0.5\">{formatCurrency(item.actual_amount)}</td>\n                  <td className=\"py-0.5 pl-2 text-[10px]\">{item.description}</td>\n                </tr>\n              ))}\n              <tr className=\"border-t border-black font-bold\">\n                <td className=\"py-1\">小計</td>\n                <td className=\"text-right py-1\">{formatCurrency(expenseBudgetSubtotal)}</td>\n                <td className=\"text-right py-1\">{formatCurrency(expenseActualSubtotal)}</td>\n                <td></td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        {/* Summary */}\n        <div className=\"mb-4 break-inside-avoid\">\n          <h2 className=\"text-base font-bold border-b border-black mb-1\">次年度繰越金</h2>\n          <table className=\"w-full text-xs\">\n            <tbody>\n              <tr>\n                <td className=\"py-0.5 w-[50%]\">収入合計</td>\n                <td className=\"text-right py-0.5\">{formatCurrency(incomeActualSubtotal)}</td>\n              </tr>\n              <tr>\n                <td className=\"py-0.5\">支出合計</td>\n                <td className=\"text-right py-0.5 border-b border-black\">{formatCurrency(expenseActualSubtotal)}</td>\n              </tr>\n              <tr className=\"font-bold text-sm\">\n                <td className=\"py-1.5\">収支差引合計（次年度繰越）</td>\n                <td className=\"text-right py-1.5\">{formatCurrency(incomeActualSubtotal - expenseActualSubtotal)}</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        {/* Footer */}\n        <div className=\"mt-8 text-xs break-inside-avoid\">\n          <div className=\"mb-2 text-right\">{formatDateJP(reportDate)}</div>\n          <p className=\"mb-4\">上記の通り会計報告致します。</p>\n          <div className=\"flex justify-end gap-8\">\n            <div>\n              <span className=\"font-bold mr-2\">会計：</span>\n              <span>{accountant}</span>\n            </div>\n            <div>\n              <span className=\"font-bold mr-2\">会計監査：</span>\n              <span>{auditorNames}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/members/ChildList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/members/GuardianList.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useMemo\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":66,"column":17,"nodeType":"Identifier","endLine":66,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useMemo, useState } from 'react';\nimport { calculateAge, calculateGrade } from '@/lib/grade-utils';\nimport Link from 'next/link';\nimport { Search, ArrowUpDown, ChevronUp, ChevronDown } from 'lucide-react';\nimport { Input } from '@/components/ui/input';\n\ninterface GuardianListProps {\n  profiles: any[];\n  targetFiscalYear: number;\n  canEdit?: boolean;\n}\n\nexport default function GuardianList({ profiles, targetFiscalYear, canEdit }: GuardianListProps) {\n\n  const [sortConfig, setSortConfig] = useState<{ key: string; direction: 'asc' | 'desc' } | null>({\n    key: 'joined_at',\n    direction: 'desc',\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const filteredProfiles = useMemo(() => {\n    let list = [...(profiles || [])];\n\n    // Search filter\n    if (searchQuery) {\n      const s = searchQuery.toLowerCase();\n      list = list.filter(p =>\n        p.full_name?.toLowerCase().includes(s) ||\n        p.last_name_kana?.includes(s) ||\n        p.first_name_kana?.includes(s) ||\n        p.email?.toLowerCase().includes(s) ||\n        p.phone?.includes(s) ||\n        p.address?.toLowerCase().includes(s)\n      );\n    }\n\n    // Sort\n    if (sortConfig) {\n      list.sort((a, b) => {\n        let valA = a[sortConfig.key];\n        let valB = b[sortConfig.key];\n\n        if (sortConfig.key === 'joined_at') {\n          valA = new Date(a.joined_at).getTime();\n          valB = new Date(b.joined_at).getTime();\n        }\n\n        if (valA === undefined || valA === null) return 1;\n        if (valB === undefined || valB === null) return -1;\n\n        if (valA < valB) return sortConfig.direction === 'asc' ? -1 : 1;\n        if (valA > valB) return sortConfig.direction === 'asc' ? 1 : -1;\n        return 0;\n      });\n    }\n\n    return list;\n  }, [profiles, searchQuery, sortConfig]);\n\n  if (!profiles || profiles.length === 0) {\n    return <div className=\"p-4 text-center text-muted-foreground\">登録されている保護者（会員）はいません。</div>;\n  }\n\n  const stats = useMemo(() => {\n    // Count 'households' - technically every profile in this list is a guardian/member\n    // The user specifically asked: \"Display count of guardians who have children registered as members\"\n    const householdCount = profiles.filter(p => p.children && p.children.length > 0).length;\n    return {\n      total: profiles.length,\n      householdCount\n    };\n  }, [profiles]);\n\n  const requestSort = (key: string) => {\n    let direction: 'asc' | 'desc' = 'asc';\n    if (sortConfig && sortConfig.key === key && sortConfig.direction === 'asc') {\n      direction = 'desc';\n    }\n    setSortConfig({ key, direction });\n  };\n\n  const getSortIcon = (key: string) => {\n    if (!sortConfig || sortConfig.key !== key) {\n      return <ArrowUpDown className=\"h-3 w-3 ml-1 text-muted-foreground/30\" />;\n    }\n    return sortConfig.direction === 'asc'\n      ? <ChevronUp className=\"h-3 w-3 ml-1 text-primary\" />\n      : <ChevronDown className=\"h-3 w-3 ml-1 text-primary\" />;\n  };\n\n  return (\n    <div>\n      {/* Statistics */}\n      <div className=\"bg-background p-4 rounded-lg shadow-sm mb-6 border border-border\">\n        <h3 className=\"text-lg font-bold text-foreground mb-3\">統計情報</h3>\n        <div className=\"flex gap-4\">\n          <div className=\"bg-primary/10 p-3 rounded-md border border-primary/20 flex-1 md:flex-none md:w-64\">\n            <span className=\"block text-sm text-primary font-medium\">会員世帯数</span>\n            <span className=\"block text-2xl font-bold text-foreground\">{stats.householdCount}世帯</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Search and Actions */}\n      <div className=\"mt-6 mb-4 flex flex-col sm:flex-row gap-3 items-end justify-between px-4 sm:px-0\">\n        <div className=\"w-full sm:max-w-xs relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <Search className=\"h-4 w-4 text-muted-foreground\" />\n          </div>\n          <Input\n            type=\"text\"\n            placeholder=\"お名前、かな、メール等で検索...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n        <div className=\"text-xs text-muted-foreground italic mr-2 sm:mr-0\">\n          {filteredProfiles.length}名を表示中\n        </div>\n      </div>\n      <div className=\"mt-8 flow-root\">\n        <div className=\"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8\">\n          <div className=\"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8\">\n            <div className=\"overflow-hidden shadow-sm ring-1 ring-border sm:rounded-lg bg-background\">\n              {filteredProfiles.length === 0 ? (\n                <div className=\"p-12 text-center text-muted-foreground\">\n                  検索条件に一致する保護者は見つかりませんでした。\n                </div>\n              ) : (\n                <table className=\"min-w-full divide-y divide-border\">\n                  <thead className=\"bg-muted/50\">\n                    <tr>\n                      <th scope=\"col\" onClick={() => requestSort('full_name')} className=\"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-foreground sm:pl-6 cursor-pointer hover:bg-muted/70\">\n                        <div className=\"flex items-center\">名前 (保護者) {getSortIcon('full_name')}</div>\n                      </th>\n                      <th scope=\"col\" onClick={() => requestSort('email')} className=\"px-3 py-3.5 text-left text-sm font-semibold text-foreground cursor-pointer hover:bg-muted/70\">\n                        <div className=\"flex items-center\">メールアドレス {getSortIcon('email')}</div>\n                      </th>\n                      <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-foreground\">\n                        連絡先\n                      </th>\n                      <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-foreground\">\n                        お子様\n                      </th>\n                      <th scope=\"col\" onClick={() => requestSort('joined_at')} className=\"px-3 py-3.5 text-left text-sm font-semibold text-foreground cursor-pointer hover:bg-muted/70\">\n                        <div className=\"flex items-center\">登録日 {getSortIcon('joined_at')}</div>\n                      </th>\n                      {canEdit && <th scope=\"col\" className=\"relative py-3.5 pl-3 pr-4 sm:pr-6\"><span className=\"sr-only\">操作</span></th>}\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y divide-border bg-background\">\n                    {filteredProfiles?.map((person, index) => (\n                      <tr key={person.id} className={index % 2 === 0 ? 'bg-background' : 'bg-muted/30'}>\n                        <td className=\"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-foreground sm:pl-6\">\n                          <div>\n                            {person.full_name || '未設定'}\n                            {person.is_admin && <span className=\"ml-2 inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary ring-1 ring-inset ring-primary/15\">管理者</span>}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            {person.last_name_kana} {person.first_name_kana}\n                          </div>\n                        </td>\n                        <td className=\"whitespace-nowrap px-3 py-4 text-sm text-muted-foreground\">{person.email}</td>\n                        <td className=\"whitespace-nowrap px-3 py-4 text-sm text-muted-foreground\">{person.phone || '-'}</td>\n                        <td className=\"px-3 py-4 text-sm text-muted-foreground\">\n                          {person.children && person.children.length > 0 ? (\n                            <ul className=\"list-disc list-inside\">\n                              {person.children.map((child: any) => (\n                                <li key={child.id}>\n                                  {child.full_name}\n                                  <span className=\"text-xs text-muted-foreground ml-1\">({child.last_name_kana} {child.first_name_kana})</span>\n                                  <span className=\"ml-1 text-muted-foreground\">\n                                    - {child.gender === 'male' ? '男' : child.gender === 'female' ? '女' : '他'}\n                                    {child.birthday && ` ${calculateGrade(child.birthday, targetFiscalYear)} (${calculateAge(child.birthday, targetFiscalYear)}歳)`}\n                                  </span>\n                                </li>\n                              ))}\n                            </ul>\n                          ) : (\n                            <span className=\"text-muted-foreground\">登録なし</span>\n                          )}\n                        </td>\n                        <td className=\"whitespace-nowrap px-3 py-4 text-sm text-muted-foreground\">\n                          {new Date(person.joined_at).toLocaleDateString()}\n                        </td>\n                        {canEdit && (\n                          <td className=\"whitespace-nowrap px-3 py-4 text-sm text-right\">\n                            <Link\n                              href={`/admin/users/${person.id}?view=guardian`}\n                              className=\"text-primary hover:text-primary bg-primary/10 px-3 py-1 rounded-md text-xs font-medium border border-primary/20\"\n                            >\n                              編集\n                            </Link>\n                          </td>\n                        )}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div >\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/members/MemberTabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/members/OfficerList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/users/AdminChildForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/users/AdminChildList.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useRouter\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":45,"column":18,"nodeType":"Identifier","endLine":45,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { adminDeleteChild, adminDeleteAllChildrenFromParent } from '@/app/admin/actions/user'\nimport Link from 'next/link'\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { calculateGrade, getGradeOrder } from '@/lib/grade-utils'\n\ntype Props = {\n  childrenData: any[]\n  parentId: string\n  targetFiscalYear: number\n}\n\nexport default function AdminChildList({ childrenData, parentId, targetFiscalYear }: Props) {\n\n  // Internal delete button component to handle state per child\n  const DeleteButton = ({ childId }: { childId: string }) => {\n    const [message, setMessage] = useState<string | null>(null)\n\n    const handleDelete = async (formData: FormData) => {\n      if (!confirm('本当に削除しますか？')) return\n\n      const result = await adminDeleteChild(formData)\n      if (result && !result.success) {\n        setMessage(result.message)\n        setTimeout(() => setMessage(null), 3000)\n      }\n    }\n\n    return (\n      <form action={handleDelete}>\n        <input type=\"hidden\" name=\"child_id\" value={childId} />\n        <input type=\"hidden\" name=\"parent_id\" value={parentId} />\n        {message && <span className=\"text-xs text-red-500 mr-2\">{message}</span>}\n        <button type=\"submit\" className=\"text-sm text-red-600 hover:text-red-900 bg-red-50 px-2 py-1 rounded border border-red-100\">削除</button>\n      </form>\n    )\n  }\n\n  if (!childrenData || childrenData.length === 0) {\n    return <div className=\"p-4 text-center text-gray-500 bg-white rounded-md border border-gray-200\">登録されているお子様はいません。</div>\n  }\n\n  const router = useRouter()\n  const handleDeleteAll = async () => {\n    if (!confirm('この保護者に登録されているすべてのお子様を削除しますか？\\nこの操作は取り消せません。')) return\n\n    const formData = new FormData()\n    formData.append('parent_id', parentId)\n    const result = await adminDeleteAllChildrenFromParent(formData)\n    if (!result.success) {\n      alert(result.message)\n    } else {\n      router.refresh()\n    }\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex justify-end\">\n        <button\n          onClick={handleDeleteAll}\n          className=\"text-xs text-red-600 hover:text-red-900 bg-red-50 px-3 py-1.5 rounded border border-red-200 font-medium\"\n        >\n          登録されている子供を全員削除\n        </button>\n      </div>\n      <div className=\"overflow-x-auto rounded-lg border border-gray-200 shadow-sm\">\n        <table className=\"min-w-full divide-y divide-gray-200 text-sm\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-4 py-3 text-left font-semibold text-gray-900\">学年</th>\n              <th className=\"px-4 py-3 text-left font-semibold text-gray-900\">氏名</th>\n              <th className=\"px-4 py-3 text-left font-semibold text-gray-900\">生年月日 / 性別</th>\n              <th className=\"px-4 py-3 text-left font-semibold text-gray-900\">アレルギー / 備考</th>\n              <th className=\"px-4 py-3 text-right font-semibold text-gray-900\">操作</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-gray-200 bg-white\">\n            {childrenData.map((child) => {\n              const grade = calculateGrade(child.birthday, targetFiscalYear)\n              const isEven = getGradeOrder(grade) % 2 === 0\n\n              return (\n                <tr key={child.id} className={`hover:bg-gray-50/80 transition-colors ${isEven ? 'bg-white' : 'bg-indigo-50/30'}`}>\n                  <td className=\"px-4 py-4 whitespace-nowrap font-medium text-gray-900\">{grade}</td>\n                  <td className=\"px-4 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"font-medium text-gray-900\">{child.full_name}</span>\n                      <span className=\"text-xs text-gray-500\">({child.last_name_kana} {child.first_name_kana})</span>\n                    </div>\n                  </td>\n                  <td className=\"px-4 py-4 whitespace-nowrap text-gray-500\">\n                    {child.birthday ? new Date(child.birthday).toLocaleDateString() : '-'}\n                    {' / '}\n                    {child.gender === 'male' ? '男' : child.gender === 'female' ? '女' : '他'}\n                  </td>\n                  <td className=\"px-4 py-4 text-gray-500\">\n                    {child.allergies && (\n                      <p className=\"text-red-500 font-medium mb-1 line-clamp-1\" title={child.allergies}>⚠ {child.allergies}</p>\n                    )}\n                    {child.notes && (\n                      <p className=\"text-xs line-clamp-1\" title={child.notes}>{child.notes}</p>\n                    )}\n                  </td>\n                  <td className=\"px-4 py-4 text-right\">\n                    <div className=\"flex justify-end items-center gap-3\">\n                      <Link\n                        href={`/admin/users/${parentId}/children/${child.id}`}\n                        className=\"text-sm text-indigo-600 hover:text-indigo-900 bg-indigo-50 px-2 py-1 rounded border border-indigo-100\"\n                      >\n                        編集\n                      </Link>\n                      <DeleteButton childId={child.id} />\n                    </div>\n                  </td>\n                </tr>\n              )\n            })}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/admin/users/AdminUserForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/forum/ForumCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/forum/ForumSearch.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`updateParams` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/Users/macuser/work_local/2025/12_kodomokai/frontend/components/forum/ForumSearch.tsx:19:7\n  17 |   useEffect(() => {\n  18 |     if (debouncedValue !== currentQuery) {\n> 19 |       updateParams('q', debouncedValue)\n     |       ^^^^^^^^^^^^ `updateParams` accessed before it is declared\n  20 |     }\n  21 |   }, [debouncedValue])\n  22 |\n\n/Users/macuser/work_local/2025/12_kodomokai/frontend/components/forum/ForumSearch.tsx:23:3\n  21 |   }, [debouncedValue])\n  22 |\n> 23 |   const updateParams = (key: string, value: string) => {\n     |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 24 |     const params = new URLSearchParams(searchParams.toString())\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 25 |     if (value) {\n     …\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 33 |     })\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 34 |   }\n     | ^^^^ `updateParams` is declared here\n  35 |\n  36 |   return (\n  37 |     <div className=\"space-y-12\">","line":19,"column":7,"nodeType":null,"endLine":19,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentQuery' and 'updateParams'. Either include them or remove the dependency array.","line":21,"column":6,"nodeType":"ArrayExpression","endLine":21,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [currentQuery, debouncedValue, updateParams]","fix":{"range":[678,694],"text":"[currentQuery, debouncedValue, updateParams]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useTransition, useEffect } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport { Search, X } from 'lucide-react'\nimport { useDebounce } from '@/lib/hooks/use-debounce'\n\nexport default function ForumSearch() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const [isPending, startTransition] = useTransition()\n\n  const currentQuery = searchParams.get('q') || ''\n  const [inputValue, setInputValue] = useState(currentQuery)\n  const debouncedValue = useDebounce(inputValue, 500)\n\n  useEffect(() => {\n    if (debouncedValue !== currentQuery) {\n      updateParams('q', debouncedValue)\n    }\n  }, [debouncedValue])\n\n  const updateParams = (key: string, value: string) => {\n    const params = new URLSearchParams(searchParams.toString())\n    if (value) {\n      params.set(key, value)\n    } else {\n      params.delete(key)\n    }\n\n    startTransition(() => {\n      router.push(`/forum?${params.toString()}`)\n    })\n  }\n\n  return (\n    <div className=\"space-y-12\">\n      <div className=\"relative max-w-md\">\n        <Search className={`absolute left-4 top-1/2 -translate-y-1/2 transition-colors ${isPending ? 'text-white animate-pulse' : 'text-indigo-300'}`} size={20} />\n        <input\n          type=\"text\"\n          value={inputValue}\n          onChange={(e) => setInputValue(e.target.value)}\n          placeholder=\"キーワードで検索\"\n          className=\"w-full bg-white/10 border border-white/20 rounded-2xl py-4 pl-12 pr-12 text-white placeholder:text-indigo-200 focus:outline-none focus:bg-white/20 transition-all backdrop-blur-md\"\n        />\n        {inputValue && (\n          <button\n            onClick={() => setInputValue('')}\n            className=\"absolute right-4 top-1/2 -translate-y-1/2 text-indigo-300 hover:text-white transition-colors p-1\"\n            title=\"検索をクリア\"\n          >\n            <X size={18} />\n          </button>\n        )}\n      </div>\n\n      <div className=\"flex items-center justify-between mt-12 px-2 -mx-2\">\n        <h3 className=\"text-xl font-bold text-gray-900 flex items-center gap-2\">\n          最近の質問\n        </h3>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/forum/QuestionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/forum/ReactionBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/ui/CopyLinkButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/ui/CopyToClipboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/ui/MarkdownEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/components/ui/input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/calendar.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/date-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/fiscal-year.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/grade-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/hooks/use-debounce.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/security.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/supabase/admin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/supabase/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/supabase/middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/supabase/server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/lib/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/macuser/work_local/2025/12_kodomokai/frontend/postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
